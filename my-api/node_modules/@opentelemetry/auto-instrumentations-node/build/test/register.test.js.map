{"version":3,"file":"register.test.js","sourceRoot":"","sources":["../../test/register.test.ts"],"names":[],"mappings":";;AAAA;;;;;;;;;;;;;;GAcG;AACH,+BAAiC;AACjC,8CAA8C;AAC9C,iCAAiC;AAEjC,MAAM,IAAI,GAAG,IAAA,gBAAS,EAAC,YAAY,CAAC,IAAI,CAAC,CAAC;AAE1C,QAAQ,CAAC,UAAU,EAAE;IACnB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IACnB,EAAE,CAAC,iDAAiD,EAAE,KAAK,IAAI,EAAE;QAC/D,OAAO,CAAC,GAAG,CAAC,4BAA4B,GAAG,MAAM,CAAC;QAClD,OAAO,CAAC,GAAG,CAAC,oBAAoB,GAAG,SAAS,CAAC;QAE7C,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAI,CAC3B,+DAA+D,CAChE,CAAC;QAEF,MAAM,CAAC,EAAE,CACP,MAAM,CAAC,QAAQ,CACb,8DAA8D,CAC/D,CACF,CAAC;QAEF,oEAAoE;QACpE,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;QAE1C,OAAO,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC;QAChD,OAAO,OAAO,CAAC,GAAG,CAAC,oBAAoB,CAAC;IAC1C,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { promisify } from 'util';\nimport * as childProcess from 'child_process';\nimport * as assert from 'assert';\n\nconst exec = promisify(childProcess.exec);\n\ndescribe('Register', function () {\n  this.timeout(5000);\n  it('can load auto instrumentation from command line', async () => {\n    process.env.OTEL_NODE_RESOURCE_DETECTORS = 'none';\n    process.env.OTEL_TRACES_EXPORTER = 'console';\n\n    const { stdout } = await exec(\n      'node --require ./build/src/register.js ./test/test-app/app.js'\n    );\n\n    assert.ok(\n      stdout.includes(\n        'OpenTelemetry automatic instrumentation started successfully'\n      )\n    );\n\n    //Check a span has been generated for the GET request done in app.js\n    assert.ok(stdout.includes(\"name: 'GET'\"));\n\n    delete process.env.OTEL_NODE_RESOURCE_DETECTORS;\n    delete process.env.OTEL_TRACES_EXPORTER;\n  });\n});\n"]}